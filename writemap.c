#include <stdio.h>
#include <sys/mman.h>
#include <fcntl.h>
#include <unistd.h>
#include <arpa/inet.h>
#define MAPPED_SIZE 4096//place the size here
#define DDR_RAM_PHYS 0x2000//place the physical address here

unsigned int buff_64[] = {
0x00151757,0xc7ff004e,
0x46324303,0x08004500,
0x00320000,0x40004011,
0x26b50a01,0x00020a01,
0x00035000,0x5000001e,
0xc24c4865,0x6c6c6f20,
0x20202020,0x30313233,
0x34353637,0x38392022
};

unsigned int buff_512[] = {
0x00151757,0xc7ff004e,
0x46324303,0x08004500,
0x01f20000,0x40004011,
0x24f50a01,0x00020a01,
0x00035000,0x500001de,
0x9d834142,0x43444546,
0x47414243,0x44454647,
0x41424344,0x45464741,
0x42434445,0x46474142,
0x43444546,0x47414243,
0x44454647,0x41424344,
0x45464741,0x42434445,
0x46474142,0x43444546,
0x47414243,0x44454647,
0x41424344,0x45464741,
0x42434445,0x46474142,
0x43444546,0x47414243,
0x44454647,0x41424344,
0x45464741,0x42434445,
0x46474142,0x43444546,
0x47414243,0x44454647,
0x41424344,0x45464741,
0x42434445,0x46474142,
0x43444546,0x47414243,
0x44454647,0x41424344,
0x45464741,0x42434445,
0x46474142,0x43444546,
0x47414243,0x44454647,
0x41424344,0x45464741,
0x42434445,0x46474142,
0x43444546,0x47414243,
0x44454647,0x41424344,
0x45464741,0x42434445,
0x46474142,0x43444546,
0x47414243,0x44454647,
0x41424344,0x45464741,
0x42434445,0x46474142,
0x43444546,0x47414243,
0x44454647,0x41424344,
0x45464741,0x42434445,
0x46474142,0x43444546,
0x47414243,0x44454647,
0x41424344,0x45464741,
0x42434445,0x46474142,
0x43444546,0x47414243,
0x44454647,0x41424344,
0x45464741,0x42434445,
0x46474142,0x43444546,
0x47414243,0x44454647,
0x41424344,0x45464741,
0x42434445,0x46474142,
0x43444546,0x47414243,
0x44454647,0x41424344,
0x45464741,0x42434445,
0x46474142,0x43444546,
0x47414243,0x44454647,
0x41424344,0x45464741,
0x42434445,0x46474142,
0x43444546,0x47414243,
0x44454647,0x41424344,
0x45464741,0x42434445,
0x46474142,0x43444546,
0x47414243,0x44454647,
0x41424344,0x45464741
};

unsigned int buff_1024[] = {
    0x00151757,0xc7ff004e,
    0x46324303,0x08004500,
    0x03f20000,0x40004011,
    0x22f50a01,0x00020a01,
    0x00035000,0x500003de,
    0x583e4142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142,
    0x43444546,0x47414243,
    0x44454647,0x41424344,
    0x45464741,0x42434445,
    0x46474142,0x43444546,
    0x47414243,0x44454647,
    0x41424344,0x45464741,
    0x42434445,0x46474142
};

int main(int argc, char *argv[]){
    int _fdmem;
    unsigned int *map = NULL;
    const char memDevice[] = "/dev/mem";
    unsigned int *buff = NULL;
    int len = 0;
    if(argc != 2){
	printf("Usage: writemap <data length>\n");
	return -1;
    }
    len = atoi(argv[1]);
    if(len == 512){
	buff = buff_512;
    } else if(len == 1024) {
	buff = buff_1024;
    } else {
	buff = buff_64;
	len = 64;
    }

    /* open /dev/mem and error checking */
    _fdmem = open( memDevice, O_RDWR | O_SYNC );

    if (_fdmem < 0){
        perror("Failed to open the /dev/mem !\n");
	return 0;
    } else {
        printf("open /dev/mem successfully !\n");
    }

    /* mmap() the opened /dev/mem */
    map= (unsigned int *)mmap(NULL,MAPPED_SIZE,PROT_READ|PROT_WRITE,MAP_SHARED,_fdmem,DDR_RAM_PHYS);
    if(!map){
        perror("mmap failed");
        close(_fdmem);
        return -1;
    }
    /* use 'map' pointer to access the mapped area! */
    int i;
    for (i=0;i< len/sizeof(unsigned int);i++){
        *(map+i) = htonl(buff[i]);
        printf("0x%08x\n", *(map+i));
    }

    /* unmap the area & error checking */
    if (munmap(map,MAPPED_SIZE)==-1){
        perror("Error un-mmapping the file");
    }
    getchar();
    /* close the character device */
    close(_fdmem);
    return 0;
}

